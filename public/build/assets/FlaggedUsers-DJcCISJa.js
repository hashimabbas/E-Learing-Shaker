import{d as h,c as u,j as e,H as p,T as g,L as j,b as x}from"./app-D8C9BZo6.js";import{c as v}from"./app-layout-DvAG5TC7.js";import{B as f}from"./button-D4FbPryL.js";import{C as N,d as b,a as y,c as w,b as _}from"./card-DVVtNjf4.js";import{B as r}from"./badge-DL5WbJP8.js";import{s as m,G as k}from"./sheet-DppquWAv.js";import{I as C}from"./input-BskDEhZ-.js";import{S}from"./search-DWmq6K0p.js";import{M as U}from"./monitor-CgFbEAzG.js";import{C as B}from"./circle-check-big-PvjPuKgJ.js";/* empty css            */import"./index-BxTnrzOQ.js";import"./index-wqlmAXvI.js";import"./index-Dc5gxj5P.js";import"./sparkles-CIrEfV2I.js";import"./chevron-right-ilZYw_Oc.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]],L=h("ShieldOff",M);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],A=h("UserX",z);function V(t){const s=u.c(8),{users:i}=t;let l;s[0]===Symbol.for("react.memo_cache_sentinel")?(l=e.jsx(p,{title:"Security Â· Flagged Users"}),s[0]=l):l=s[0];let o;s[1]===Symbol.for("react.memo_cache_sentinel")?(o=e.jsx("div",{className:"border-b bg-destructive/10 py-10",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-extrabold tracking-tight md:text-4xl flex items-center gap-3 text-destructive",children:[e.jsx(g,{className:"h-8 w-8"})," Flagged Users"]}),e.jsx("p",{className:"text-muted-foreground font-medium text-lg",children:"Users flagged for suspicious behavior or security violations."})]})})})}),s[1]=o):o=s[1];let c;s[2]===Symbol.for("react.memo_cache_sentinel")?(c=e.jsxs("div",{children:[e.jsx(N,{className:"text-xl font-bold",children:"Suspicious Activity Monitor"}),e.jsx(b,{children:"Review and manage flagged accounts"})]}),s[2]=c):c=s[2];let n;s[3]===Symbol.for("react.memo_cache_sentinel")?(n=e.jsxs(y,{className:"flex flex-row items-center justify-between",children:[c,e.jsxs("div",{className:"relative w-full max-w-sm hidden md:block",children:[e.jsx(S,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(C,{placeholder:"Search users...",className:"pl-9 rounded-full bg-muted/50 border-none focus-visible:ring-1"})]})]}),s[3]=n):n=s[3];let a;s[4]!==i.data?(a=i.data.length>0?i.data.map(F):e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:e.jsx("p",{children:"No flagged users found. Good job!"})}),s[4]=i.data,s[5]=a):a=s[5];let d;return s[6]!==a?(d=e.jsxs(v,{children:[l,e.jsxs("div",{className:"bg-background min-h-screen pb-20",children:[o,e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs(w,{className:"border-none shadow-md overflow-hidden",children:[n,e.jsx(_,{className:"space-y-4",children:a})]})})]})]}),s[6]=a,s[7]=d):d=s[7],d}function F(t){return e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between p-4 rounded-xl border bg-card hover:shadow-sm transition-all gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-destructive/10 flex items-center justify-center shrink-0",children:e.jsx(A,{className:"h-6 w-6 text-destructive"})}),e.jsxs("div",{children:[e.jsx(j,{href:m("admin.security.user",t.id),className:"font-bold text-lg hover:underline flex items-center gap-2",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.email}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsxs(r,{variant:"secondary",className:"font-mono",children:["Score: ",t.suspicion_score]}),e.jsxs(r,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3"})," ",t.ip_count," IPs"]}),e.jsxs(r,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(U,{className:"h-3 w-3"})," ",t.device_count," Devices"]}),t.is_suspicious&&e.jsx(r,{variant:"destructive",className:"font-bold",children:"Blocked"}),t.warned_at&&!t.is_suspicious&&e.jsx(r,{className:"bg-orange-100 text-orange-800 hover:bg-orange-200 border-orange-200",children:"Warned"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto mt-2 md:mt-0",children:[e.jsxs(f,{variant:"secondary",size:"sm",className:"font-bold",onClick:()=>x.post(m("admin.security.force-logout",t.id)),children:[e.jsx(L,{className:"mr-2 h-4 w-4"})," Force Logout"]}),t.is_suspicious&&e.jsxs(f,{size:"sm",variant:"outline",className:"font-bold text-green-600 border-green-200 hover:bg-green-50 hover:text-green-700",onClick:()=>x.post(m("admin.security.unflag",t.id)),children:[e.jsx(B,{className:"mr-2 h-4 w-4"})," Unflag"]})]})]},t.id)}export{V as default};
