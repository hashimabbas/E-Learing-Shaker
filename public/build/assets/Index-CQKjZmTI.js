import{c as w,j as e,H as S,L as g,T as k,b as v}from"./app-XyPvf5SD.js";import{c as C}from"./app-layout-D2vXKArG.js";import{C as T,d as D,a as I,c as L,b as A}from"./card-DkM8ndGh.js";import{B as u}from"./button-CHjdATuu.js";import{s as p,G as B}from"./sheet-B0klKXIZ.js";import{b as H,T as N,c as r,a,d as R,e as U}from"./table-DkIE2388.js";import{B as y}from"./badge-Dj0IGrYk.js";import{I as E}from"./input-BV9Sw1oX.js";import{S as z}from"./shield-alert-EnvKbcIB.js";import{S as M}from"./search-B5GzQm7C.js";import{M as F}from"./monitor-Bv-O1PhE.js";import{E as G}from"./eye-dSde0CH4.js";/* empty css            */import"./index-BfGo3Iya.js";import"./index-fzUbA7uZ.js";import"./index-Dc5gxj5P.js";import"./sparkles-Q-DkQsKb.js";import"./chevron-right-Cm5lg-zA.js";function oe(j){const s=w.c(12),{sessions:b}=j,_=P;let i;s[0]===Symbol.for("react.memo_cache_sentinel")?(i=e.jsx(S,{title:"Security Dashboard"}),s[0]=i):i=s[0];let o;s[1]===Symbol.for("react.memo_cache_sentinel")?(o=e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-extrabold tracking-tight md:text-4xl flex items-center gap-3",children:[e.jsx(z,{className:"h-8 w-8 text-primary"})," Security Dashboard"]}),e.jsx("p",{className:"text-muted-foreground font-medium text-lg",children:"Monitor active sessions and potential security risks."})]}),s[1]=o):o=s[1];let n;s[2]===Symbol.for("react.memo_cache_sentinel")?(n=p("admin.security.flagged"),s[2]=n):n=s[2];let c;s[3]===Symbol.for("react.memo_cache_sentinel")?(c=e.jsx("div",{className:"border-b bg-muted/30 py-10",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[o,e.jsx("div",{className:"flex gap-3",children:e.jsx(g,{href:n,children:e.jsxs(u,{className:"h-12 rounded-full px-6 font-bold shadow-lg shadow-destructive/20",variant:"destructive",children:[e.jsx(k,{className:"mr-2 h-5 w-5"})," View Flagged Users"]})})})]})})}),s[3]=c):c=s[3];let d;s[4]===Symbol.for("react.memo_cache_sentinel")?(d=e.jsxs("div",{children:[e.jsx(T,{className:"text-xl font-bold",children:"Active Sessions"}),e.jsx(D,{children:"Real-time monitoring of user activity"})]}),s[4]=d):d=s[4];let m;s[5]===Symbol.for("react.memo_cache_sentinel")?(m=e.jsxs(I,{className:"flex flex-row items-center justify-between",children:[d,e.jsxs("div",{className:"relative w-full max-w-sm hidden md:block",children:[e.jsx(M,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(E,{placeholder:"Search by IP or User ID...",className:"pl-9 rounded-full bg-muted/50 border-none focus-visible:ring-1"})]})]}),s[5]=m):m=s[5];let x;s[6]===Symbol.for("react.memo_cache_sentinel")?(x=e.jsx(H,{children:e.jsxs(N,{className:"hover:bg-transparent bg-muted/30",children:[e.jsx(r,{className:"pl-6",children:"User ID"}),e.jsx(r,{children:"IP Address"}),e.jsx(r,{children:"Device"}),e.jsx(r,{className:"text-center",children:"Actions"}),e.jsx(r,{children:"Last Seen"}),e.jsx(r,{className:"text-center",children:"Risk Level"}),e.jsx(r,{className:"text-right pr-6",children:"Controls"})]})}),s[6]=x):x=s[6];let l;if(s[7]!==b.data){let f;s[9]===Symbol.for("react.memo_cache_sentinel")?(f=t=>e.jsxs(N,{className:"hover:bg-muted/50 border-b border-muted/60 last:border-0",children:[e.jsx(a,{className:"font-medium pl-6",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs",children:t.user_id})})}),e.jsx(a,{className:"font-mono text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-3 w-3"})," ",t.ip_address]})}),e.jsx(a,{children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(F,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[150px]",title:t.device_fingerprint,children:t.device_fingerprint?t.device_fingerprint.slice(0,20)+"...":"Unknown"})]})}),e.jsx(a,{className:"text-center",children:e.jsx(y,{variant:"secondary",className:"font-mono",children:t.actions_count})}),e.jsx(a,{className:"text-xs text-muted-foreground",children:new Date(t.last_seen).toLocaleString()}),e.jsx(a,{className:"text-center",children:e.jsxs(y,{variant:"outline",className:_(t.risk_level),children:[t.risk_level.toUpperCase()," (",t.risk_score,")"]})}),e.jsxs(a,{className:"text-right pr-6 space-x-2",children:[e.jsx(g,{href:p("admin.security.show",t.session_id),children:e.jsx(u,{size:"icon",variant:"ghost",className:"h-8 w-8 text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:e.jsx(G,{className:"h-4 w-4"})})}),e.jsx(u,{size:"sm",variant:"ghost",className:"h-8 text-orange-600 hover:text-orange-700 hover:bg-orange-50 font-bold text-xs",onClick:()=>v.post(p("admin.security.session.revoke",t.session_id)),children:"Kill"}),e.jsx(u,{size:"sm",variant:"ghost",className:"h-8 text-destructive hover:text-destructive hover:bg-destructive/10 font-bold text-xs",onClick:()=>v.post(p("admin.security.force-logout",t.user_id)),children:"Force Logout"})]})]},t.session_id),s[9]=f):f=s[9],l=b.data.map(f),s[7]=b.data,s[8]=l}else l=s[8];let h;return s[10]!==l?(h=e.jsxs(C,{children:[i,e.jsxs("div",{className:"bg-background min-h-screen pb-20",children:[c,e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs(L,{className:"border-none shadow-md overflow-hidden",children:[m,e.jsx(A,{className:"p-0",children:e.jsxs(R,{children:[x,e.jsx(U,{children:l})]})})]})})]})]}),s[10]=l,s[11]=h):h=s[11],h}function P(j){switch(j){case"high":return"bg-red-50 text-red-700 border-red-200";case"medium":return"bg-yellow-50 text-yellow-700 border-yellow-200";default:return"bg-green-50 text-green-700 border-green-200"}}export{oe as default};
