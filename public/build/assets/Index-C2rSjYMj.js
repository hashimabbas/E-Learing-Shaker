import{d as U,c as q,u as B,r as n,j as e,H as D,L as P,b as z}from"./app-rmzb1glS.js";import{c as K}from"./app-layout-CbxCyJiW.js";import{B as h,c as N}from"./button-CcGg4s5E.js";import{s as u,X as A,A as W}from"./sheet-NHf8RcMw.js";import{M as X}from"./menu-CFwCiRz4.js";import{C as S}from"./clock-BFaR7dDl.js";import{F as M}from"./file-text-B__-Nlmv.js";import{C}from"./circle-help-DcroknIO.js";import{C as J}from"./chevron-right-CaP7d2yU.js";import{A as Q}from"./arrow-left-YACAOCdR.js";import{C as G}from"./circle-check-big-Ccto-H2R.js";import{P as Y}from"./play-CYb93zUB.js";import{V as Z}from"./video-ZfiLkW4Y.js";/* empty css            */import"./index-DBuc7Kqw.js";import"./index-Tbvhi0CX.js";import"./index-Dc5gxj5P.js";import"./book-open-Cxpv8fKw.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],ee=U("ClipboardCheck",L),I=()=>({top:`${Math.floor(Math.random()*70)+10}%`,left:`${Math.floor(Math.random()*70)+10}%`});function te(){const a=q.c(9),{auth:r}=B().props,s=r.user,d=s?`USER ID: ${s.id} | ${s.name} | IP: ${s.last_login_ip||"---"}`:"PLATFORM PREVIEW";let l;a[0]===Symbol.for("react.memo_cache_sentinel")?(l=I(),a[0]=l):l=a[0];const[i,j]=n.useState(l);let p,f;if(a[1]===Symbol.for("react.memo_cache_sentinel")?(p=()=>{const b=setInterval(()=>{j(I())},8e3);return()=>clearInterval(b)},f=[],a[1]=p,a[2]=f):(p=a[1],f=a[2]),n.useEffect(p,f),!s)return null;let x;a[3]!==i.left||a[4]!==i.top?(x={position:"absolute",top:i.top,left:i.left,opacity:.15,color:"white",zIndex:10,pointerEvents:"none",userSelect:"none",transition:"top 8s linear, left 8s linear"},a[3]=i.left,a[4]=i.top,a[5]=x):x=a[5];let m;return a[6]!==x||a[7]!==d?(m=e.jsx("div",{style:x,className:"text-sm md:text-md font-extrabold whitespace-nowrap bg-black/20 px-2 py-1 rotate-[-5deg]",children:d}),a[6]=x,a[7]=d,a[8]=m):m=a[8],m}const se=10,ae="video:auto-resume";function ye({course:a,lessons:r,currentLesson:s,bookmarkTime:d,enrollment:l}){const[i,j]=n.useState(0),[p,f]=n.useState(!1),[x,m]=n.useState(!1),[b,R]=n.useState(null),[E,O]=n.useState(!1),[w,T]=n.useState(!0),g=n.useRef(null),y=n.useRef(!1),_=r.findIndex(t=>t.id===s.id),v=r.find((t,o)=>o<=_?!1:!t.is_completed)??null;n.useEffect(()=>{O(localStorage.getItem(ae)==="true")},[]),n.useEffect(()=>{y.current=!1,f(!1),j(0),m(!1),R(null)},[s.id]),n.useEffect(()=>{const t=g.current;if(!t||s.type!=="video"||!d||d<=1||y.current)return;const o=()=>{if(!t.duration||t.duration<=0)return;const c=Math.min(d,t.duration-2);y.current=!0,E?(t.pause(),t.currentTime=c,requestAnimationFrame(()=>t.play().catch(()=>{}))):(R(c),m(!0))};return t.addEventListener("loadeddata",o,{once:!0}),()=>t.removeEventListener("loadeddata",o)},[s.id,d,E]);const V=n.useCallback(()=>{const t=g.current;if(!t||t.duration===0)return;const o=Math.floor(t.currentTime);if(o-i<se)return;const c=Math.round(o/t.duration*100);$(o,c)},[s.id,i]),$=(t,o)=>{fetch(u("api.progress.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({lesson_id:s.id,time_bookmark_seconds:t,progress_percentage:Math.max(o,100)})}).then(c=>{c.ok&&j(t)}).catch(()=>{})},F=()=>{fetch(u("api.progress.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({lesson_id:s.id,time_bookmark_seconds:0,progress_percentage:100})}).then(t=>{t.ok&&(z.reload(),v&&k(v))})},k=t=>{if(t.type==="quiz"&&t.quiz?.id){z.get(u("quizzes.show",t.quiz.id));return}z.visit(u("courses.learn",{course:a.slug,lesson:t.slug}),{preserveState:!1,replace:!0})},H=(t,o)=>{if(t.is_completed)return e.jsx(G,{className:"size-5 text-green-500"});if(o)return e.jsx(Y,{className:"size-5 text-primary animate-pulse fill-primary/20"});switch(t.type){case"video":return e.jsx(Z,{className:"size-5 text-slate-400"});case"text":return e.jsx(M,{className:"size-5 text-slate-400"});case"quiz":return e.jsx(C,{className:"size-5 text-slate-400"});default:return e.jsx(S,{className:"size-5 text-slate-400"})}};return e.jsxs(K,{breadcrumbs:[{title:"Learning",href:u("student.learning")},{title:a.title,href:u("courses.show",a.slug)}],children:[e.jsx(D,{title:`Learning: ${s.title}`}),e.jsxs("div",{className:"flex h-[calc(100vh-theme(spacing.16))] w-full bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-y-auto",children:[e.jsxs("div",{className:"lg:hidden p-4 border-b flex items-center justify-between bg-white dark:bg-slate-900 sticky top-0 z-30",children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>T(!w),children:w?e.jsx(A,{}):e.jsx(X,{})}),e.jsx("h2",{className:"text-sm font-bold truncate px-4",children:s.title}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"w-full bg-black relative group/player",children:s.type==="video"?e.jsxs("div",{className:"aspect-video max-h-[75vh] mx-auto relative overflow-hidden",children:[e.jsx("video",{ref:g,src:s.secure_video_url??"",controls:!0,controlsList:"nodownload",onTimeUpdate:V,poster:a.thumbnail||"",className:"w-full h-full object-contain",onEnded:()=>f(!0)},s.id),x&&b!==null&&e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-40",children:e.jsx(re,{className:"max-w-xs border-none bg-slate-900 text-white shadow-2xl",children:e.jsxs("div",{className:"p-6 text-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center mx-auto",children:e.jsx(S,{className:"size-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Resume Learning?"}),e.jsxs("p",{className:"text-slate-400 text-sm mt-1",children:["Pick up where you left off at ",new Date(b*1e3).toISOString().substr(14,5)]})]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsx(h,{className:"w-full",onClick:()=>{g.current&&(g.current.currentTime=b),m(!1)},children:"Continue Watching"}),e.jsx(h,{variant:"ghost",className:"w-full text-slate-400 hover:text-white",onClick:()=>m(!1),children:"Start Over"})]})]})})}),e.jsx(te,{})]}):e.jsx("div",{className:"aspect-video max-h-[50vh] flex items-center justify-center bg-gradient-to-br from-slate-900 to-indigo-950 p-8",children:e.jsxs("div",{className:"text-center max-w-lg",children:[e.jsx("div",{className:"inline-flex p-4 rounded-3xl bg-white/10 backdrop-blur-xl mb-6 ring-1 ring-white/20",children:s.type==="text"?e.jsx(M,{className:"size-12 text-blue-400"}):e.jsx(C,{className:"size-12 text-amber-400"})}),e.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:s.title}),e.jsxs("p",{className:"text-slate-300",children:["This is a ",s.type," based lesson. Please review the content below."]})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-12",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-primary font-semibold mb-2 uppercase tracking-wider",children:[e.jsx(W,{className:"size-4"}),"Lesson ",_+1," of ",r.length]}),e.jsx("h1",{className:"text-4xl font-extrabold text-slate-900 dark:text-white",children:s.title})]}),s.type!=="video"&&!s.is_completed&&e.jsxs(h,{size:"lg",onClick:F,className:"shadow-lg shadow-primary/20",children:[e.jsx(ee,{className:"mr-2 size-5"}),"Mark as Complete"]}),p&&v&&e.jsxs(h,{size:"lg",onClick:()=>k(v),className:"shadow-xl shadow-primary/30",children:["Next Lesson",e.jsx(J,{className:"ml-2 size-5"})]})]}),e.jsx("div",{className:"prose prose-slate dark:prose-invert max-w-none",children:e.jsx("div",{className:"p-8 rounded-3xl bg-white dark:bg-slate-900 shadow-sm border border-slate-200/50 dark:border-slate-800/50 leading-relaxed text-lg whitespace-pre-wrap",children:s.text_lesson?.content||s.description||"No content provided for this lesson."})})]}),s.type==="quiz"&&s.quiz&&e.jsxs("div",{className:"mt-12 p-8 rounded-3xl bg-amber-50 dark:bg-amber-900/10 border border-amber-200/50 dark:border-amber-900/50 flex flex-col items-center text-center",children:[e.jsx(C,{className:"size-16 text-amber-500 mb-6"}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Quiz Time!"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-8 max-w-sm",children:"Test your knowledge on the concepts covered in this section."}),e.jsx(h,{size:"lg",variant:"default",className:"bg-amber-600 hover:bg-amber-700 px-12",asChild:!0,children:e.jsx(P,{href:u("quizzes.show",s.quiz.id),children:"Start Quiz Now"})})]})]})]}),e.jsxs("aside",{className:N("w-80 bg-white dark:bg-slate-900 border-l border-slate-200/50 dark:border-slate-800/50 flex flex-col transition-all duration-300 z-40 lg:static fixed inset-y-0 right-0",w?"translate-x-0":"translate-x-full lg:translate-x-0"),children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Curriculum"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"flex-1 h-2 w-24 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary",style:{width:`${l?.progress||0}%`}})}),e.jsxs("span",{className:"text-xs font-bold text-muted-foreground",children:[Math.round(l?.progress||0),"%"]})]})]}),e.jsx(h,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>T(!1),children:e.jsx(A,{className:"size-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide py-2",children:r.map((t,o)=>{const c=t.id===s.id;return e.jsxs("button",{onClick:()=>k(t),className:N("w-full group px-6 py-4 flex items-start gap-3 transition-colors text-left",c?"bg-primary/5 active-lesson border-r-4 border-primary":"hover:bg-slate-50 dark:hover:bg-slate-800/30"),children:[e.jsx("div",{className:"mt-0.5 shrink-0 transition-transform group-hover:scale-110",children:H(t,c)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[e.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground/50",children:["Lesson ",o+1]}),e.jsxs("span",{className:"text-[10px] text-muted-foreground font-medium flex items-center gap-1",children:[e.jsx(S,{className:"size-3"}),"Video"]})]}),e.jsx("h4",{className:N("text-sm font-bold line-clamp-2 transition-colors",c?"text-primary":"text-slate-700 dark:text-slate-300"),children:t.title})]})]},t.id)})}),e.jsx("div",{className:"p-6 border-t bg-slate-50/50 dark:bg-slate-800/20",children:e.jsx(P,{href:u("courses.show",a.slug),children:e.jsxs(h,{variant:"outline",className:"w-full border-slate-200 dark:border-slate-800 text-slate-600 dark:text-slate-400",children:[e.jsx(Q,{className:"mr-2 size-4"}),"Return to Details"]})})})]})]})]})}const re=a=>{const r=q.c(5),{children:s,className:d}=a;let l;r[0]!==d?(l=N("bg-white rounded-2xl shadow-xl",d),r[0]=d,r[1]=l):l=r[1];let i;return r[2]!==s||r[3]!==l?(i=e.jsx("div",{className:l,children:s}),r[2]=s,r[3]=l,r[4]=i):i=r[4],i};export{ye as default};
